{% extends "base.html" %}

{% block title %}Plant Medic — Deteksi Penyakit Tanaman{% endblock %}

{% block body_class %}detect-page{% endblock %}

{% block head %}

<link href="{{ url_for('static', filename='css/style.css') }}" rel="stylesheet">

<!-- Tailwind CDN -->
<script src="https://cdn.tailwindcss.com"></script>

<script>
  tailwind.config = {
    theme: { 
      extend: {
        colors: {
          primary: '#16a34a',
          accent: '#047857'
        }
      }
    }
  }
</script>

<!-- Google Fonts -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800&display=swap" rel="stylesheet">

<style>
  html,body{
    font-family:Inter,ui-sans-serif,system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial
  }
  @keyframes scaleIn {
    from { opacity: 0; transform: scale(0.95); }
    to { opacity: 1; transform: scale(1); }
  }
  .fade-section {
    opacity: 0;
    transform: translateY(6px);
    animation: fadeInUp 0.4s ease forwards;
  }
  @keyframes fadeInUp {
    to { opacity: 1; transform: translateY(0); }
  }
  .desc-text {
    white-space: pre-wrap;
    word-wrap: break-word;
    overflow-wrap: break-word;
    line-height: 1.6;
    max-width: 100%;
  }
  .animate-scale-in {
    animation: scaleIn 0.2s ease-out;
  }
/* Scrollbar transparan & halus untuk #explanationContent */
#explanationContent::-webkit-scrollbar {
  width: 6px;
}

#explanationContent::-webkit-scrollbar-track {
  background: transparent;
}

#explanationContent::-webkit-scrollbar-thumb {
  background-color: rgba(209, 213, 219, 0.35); /* slate-300 */
  border-radius: 9999px;
}

#explanationContent::-webkit-scrollbar-thumb:hover {
  background-color: rgba(209, 213, 219, 0.6);
}

/* Firefox */
#explanationContent {
  scrollbar-width: thin;
  scrollbar-color: rgba(209, 213, 219, 0.35) transparent;
}

/* Dark mode */
.dark #explanationContent::-webkit-scrollbar-thumb {
  background-color: rgba(148, 163, 184, 0.35); /* slate-400 */
}

.dark #explanationContent::-webkit-scrollbar-thumb:hover {
  background-color: rgba(148, 163, 184, 0.6);
}

.dark #explanationContent {
  scrollbar-color: rgba(148, 163, 184, 0.35) transparent;
}

.scroll-transparent {
  scrollbar-width: thin;
  scrollbar-color: rgba(209,213,219,0.35) transparent;
}

.scroll-transparent::-webkit-scrollbar {
  width: 6px;
}

.scroll-transparent::-webkit-scrollbar-track {
  background: transparent;
}

.scroll-transparent::-webkit-scrollbar-thumb {
  background-color: rgba(209,213,219,0.35);
  border-radius: 9999px;
}

.scroll-transparent::-webkit-scrollbar-thumb:hover {
  background-color: rgba(209,213,219,0.6);
}

/* Dark mode */
.dark .scroll-transparent::-webkit-scrollbar-thumb {
  background-color: rgba(148,163,184,0.35);
}

.dark .scroll-transparent::-webkit-scrollbar-thumb:hover {
  background-color: rgba(148,163,184,0.6);
}


</style>

{% endblock %}

{% block content %}

<!-- ================= NAVBAR ================= -->
<header class="bg-white shadow-sm">
  <div class="max-w-6xl mx-auto px-4">
    <div class="flex justify-between items-center h-16">
      <div class="flex items-center gap-3">
        <div class="w-10 h-10 rounded-full bg-primary overflow-hidden">
          <img src="{{ url_for('static', filename='images/Logo_Pm.jpeg') }}"
               alt="Plant Medic Logo"
               class="w-full h-full object-cover">
        </div>
      <div>
          <h1 class="text-lg font-semibold">Plant Medic</h1>
          <p class="text-xs text-gray-500">Plant disease detection</p>
        </div>
      </div>

      <nav class="flex items-center gap-4 text-sm">
        <a href="#how" class="hidden sm:inline hover:text-primary">How it works</a>
        <a href="#about" class="hidden sm:inline hover:text-primary">About</a>
        <a href="{{ url_for('user_login') }}"
          class="px-3 py-2 rounded-md border border-primary text-primary hover:bg-primary hover:text-white transition">
          Sign In
        </a>
      </nav>

    </div>
  </div>
</header>

<!-- ================= HERO + UPLOAD ================= -->
<section class="max-w-6xl mx-auto py-16 grid grid-cols-1 lg:grid-cols-2 gap-12 items-tart">

  <!-- LEFT COLUMN -->
<div class="space-y-6 sm:space-y-10 lg:pr-6">


<!-- HERO -->
<div class="w-full max-w-xl mx-auto lg:mx-0 px-4 sm:px-0 text-center lg:text-left">

  <h2 class="text-2xl sm:text-3xl md:text-4xl font-extrabold">
    Plant Medic — Detecting Herbal Plant Content Based on Leaf Visuals
  </h2>

  <p class="mt-4 text-gray-600">
    Upload a photo of a plant leaf, and our system will detect the herbal plant's content.
  </p>

  <div class="mt-8 flex flex-col sm:flex-row gap-3 justify-center lg:justify-start">
    <a href="#upload"
       class="px-5 py-3 rounded-md bg-primary text-white shadow text-center">
      Try now
    </a>
    <a href="#about"
       class="px-5 py-3 rounded-md border text-center">
      Learn more
    </a>
  </div>

</div>


    <!-- HOW IT WORKS -->
    <div class="bg-white p-5 rounded-xl shadow-2xl">
      <h3 class="text-xl font-semibold mb-6">How Detection Works</h3>

      <div class="space-y-4">
        <div class="border rounded-lg p-4">
          <h4 class="font-semibold">1. Upload</h4>
          <p class="text-sm text-gray-500 mt-1">Users upload photos of plant leaves.</p>
        </div>

        <div class="border rounded-lg p-4">
          <h4 class="font-semibold">2. Model Predictions</h4>
          <p class="text-sm text-gray-500 mt-1">CNN model detects disease class and confidence.</p>
        </div>

        <div class="border rounded-lg p-4">
          <h4 class="font-semibold">3. Recommendation</h4>
          <p class="text-sm text-gray-500 mt-1">Diagnosis and treatment recommendations.</p>
        </div>
      </div>

      <footer class="mt-12 text-center text-sm text-gray-500 py-6">
        © Plant Medic
      </footer>
    </div>
  </div>

  <!-- RIGHT COLUMN: UPLOAD -->
  <div id="upload" class="bg-white p-6 rounded-xl shadow-2xl flex flex-col">

    <div class="shrink-0">
      <h3 class="text-lg font-semibold">Upload leaf photo</h3>
      <p class="text-sm text-gray-500 mt-1">Use a clear photo. Max file size 5MB.</p>
    </div>

    <form id="uploadForm" class="mt-4 flex-1 space-y-4 pr-2">
      <div id="dropZone"
        class="border-dashed border-2 border-gray-300 rounded-lg p-4 text-center transition relative">
        <input id="fileInput" name="image" type="file" accept="image/*" class="hidden" />

        <!-- PLACEHOLDER -->
        <div id="dropPlaceholder"
          class="cursor-pointer flex flex-col items-center justify-center gap-3 py-6"
          onclick="fileInput.click()">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-12 w-12 text-gray-300"
            fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"
              d="M7 16V6a1 1 0 011-1h8a1 1 0 011 1v10M7 10l5 5 5-5" />
          </svg>

          <div class="text-sm text-gray-600">Click or drag files here</div>
          <div id="fileName" class="text-xs text-gray-400"></div>
        </div>

        <!-- IMAGE PREVIEW -->
        <img id="dropPreviewImg" class="hidden w-full h-48 object-contain rounded-md" alt="Preview image"/>
      </div>

      <div class="flex gap-3">
        <button type="button" id="detectBtn"
          class="flex-1 px-4 py-3 rounded-md bg-accent text-white transition active:bg-accent/80">
          Detect now
        </button>
        <button id="clearBtn" type="button"
          class="px-4 py-3 rounded-md border transition active:bg-gray-100">
          Reset
        </button>
      </div>

      <div id="previewCard" class="hidden relative bg-gray-50 p-3 rounded-md">
        <button id="closePreview"
          class="absolute top-2 right-2 text-gray-400 hover:text-red-500 text-xl">
          &times;
        </button>
        <div class="flex gap-3 items-center">
          <img id="previewImg" class="w-24 h-24 object-cover rounded-md border block"/>
          <div>
            <div id="previewInfo" class="text-sm"></div>
            <div id="predictionBadge" class="mt-2"></div>
          </div>
        </div>
      </div>

      <div id="explanationBox" class="hidden bg-white border rounded-lg shadow-sm shrink-0">
        <div class="px-4 py-2 border-b text-sm font-semibold">Analysis explanation</div>
        <div id="explanationContent" class="p-4 text-sm space-y-2 overflow-y-auto max-h-48"></div>
      </div>

      <div id="resultArea" class="hidden shrink-0 overflow-y-auto max-h-64 scroll-transparent">
        <div class="bg-white p-4 rounded-md shadow-sm">
          <div class="flex justify-between items-center">
            <h4 class="font-semibold">Prediction results</h4>
            <div id="confidence" class="text-sm text-gray-500"></div>
          </div>
          <div id="predLabel" class="mt-3 text-xl font-bold"></div>
          <div id="recommendation" class="mt-3 text-sm text-gray-600"></div>
        </div>
      </div>


      <div id="loading"
        class="hidden flex items-center gap-3 text-sm text-gray-500">
        <svg class="animate-spin h-5 w-5 text-primary" viewBox="0 0 24 24">
          <circle class="opacity-25" cx="12" cy="12" r="10"
            stroke="currentColor" stroke-width="4"></circle>
          <path class="opacity-75" fill="currentColor"
            d="M4 12a8 8 0 018-8v8z"></path>
        </svg>
        Processing image & predicting...
      </div>
    </form>
  </div>
</section>



<script src="{{ url_for('static', filename='js/index.js') }}"></script>
{% endblock %}
